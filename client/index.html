<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html>
  <head>
    <meta http-equiv="Content-type" content="text/html; charset=utf-8">
    <title>
      CollabCoding
    </title>
    <link rel="stylesheet" href="assets/css/bootstrap.min.css" type="text/css" media="screen" charset="utf-8">
    <link rel="stylesheet" href="assets/css/jquery.treeview.css" type="text/css" media="screen" charset="utf-8">
    <link rel="stylesheet" href="assets/css/site.css" type="text/css" media="screen" charset="utf-8">
    <link rel="stylesheet" href="assets/css/ui-lightness/jquery-ui-1.8.21.custom.css" type="text/css" media="screen" charset="utf-8">
    <script type="text/javascript" charset="utf-8" src="assets/js/jquery-1.7.2.min.js"></script>
    <script type="text/javascript" charset="utf-8" src="assets/js/jquery-ui-1.8.21.custom.min.js"></script>
    <script type="text/javascript" charset="utf-8" src="assets/js/bootstrap.min.js"></script>
    <script type="text/javascript" charset="utf-8" src="assets/js/jquery.treeview.js"></script>
    <script type="text/javascript" charset="utf-8" src="assets/js/ace/ace.js"></script>
    <script type="text/javascript" charset="utf-8" src="assets/js/ace/mode-javascript.js"></script>
    <script type="text/javascript" charset="utf-8" src="assets/js/ace/mode-html.js"></script>
    <script type="text/javascript" charset="utf-8" src="assets/js/ace/mode-css.js"></script>    
    <script type="text/javascript" src="assets/js/ace/mode-coffee.js"></script>
    <script type="text/javascript" src="assets/js/ace/theme-idle_fingers.js"></script>    
    <script type="text/javascript" src="/channel/bcsocket.js"></script>
    <script type="text/javascript" src="/share/share.js"></script>
    <script type="text/javascript" src="/share/ace.js"></script>
    <style type="text/css" media="screen">
      #tabs {
        padding: 0;
        width: 100%;
        height: 100%;        
      }
      #editor {
        padding: 0;
        width: 100%;
        height: 750px;
      }
      #editor {
        font-family: "Inconsolata", sans-serif;
        font-size: 12pt;
      }
    </style>
    <script type="text/javascript" charset="utf-8">   
      var randomDocName = function(length) {
        var chars, x;
        if (length == null) {
          length = 10;
        }
        chars = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789-=";
        var name = [];
        for (x = 0; x < length; x++) {
          name.push(chars[Math.floor(Math.random() * chars.length)]);
        }
        return name.join('');
      };     
    
      $(document).ready(function() {
        $("#project-tree").treeview();
        $("#tabs").tabs();

        $("#new").bind('click', function() {
          console.log("click");
        });
  
        // set up ace and sharejs
        var editor = ace.edit("editor");
        editor.resize()
        var JavaScriptMode = require("ace/mode/javascript").Mode;
        editor.getSession().setMode(new JavaScriptMode());
        editor.setReadOnly(true);
        editor.setTheme("ace/theme/idle_fingers");  
  
        var docName;
        if (!document.location.hash) {
          docName = '#' + randomDocName();
        } else {
          docName = document.location.hash;
        }
        sharejs.open(docName, 'text', function(error, doc) {
          if (error) {
            console.error(error);   
            return;
          };       
    
          doc.attach_ace(editor);
          editor.setReadOnly(false);
        });
        // binding event
        $("#shareDoc").click(function() { 
          $("#dialog").attr('title', 'Share via this link');
          $("#dialog").text(document.location+docName);
          $("#dialog").dialog({
            modal: true,
            			buttons: {
            				Ok: function() {
            					$( this ).dialog( "close" );
            				}
          			}
          });
        });
      });  

    </script>
  </head>
  <body>
    <!-- Info Bar -->
    <div class="navbar" style="margin-bottom: 0">
      <div class="navbar-inner">
        <div class="container">
          <div class="nav-collapse collapse">
                <div style="color: #FFFFFF; position: absolute; margin-top: 10px">
                  <a id="shareDoc" class="button" herf="#">Share</a>    
                  <div id="dialog" style="display:none">
                  	
                  </div>
                </div>
              </li>
              <div style="text-align:center; padding-top: 10px;">Tool</div>
          </div>
        </div>
      </div>
    </div>
    <div class="container-fluid" style="height: 800px">
      <div class="row-fluid">
        <div class="span2" id="left-items">
          <div id="project" style="height: 400px;background-color: rgba(0, 0, 0, .2);box-shadow: inset 1px 1px 0 rgba(0, 0, 0, .1),inset 0 -1px 0 rgba(0, 0, 0, .07); background-color: #FFFFFF">
            <ul id="project-tree" class="filetree">
              <li>
                <span class="folder">Folder 1</span>
                <ul>
                  <li>
                    <span class="file">Item 1.1</span>
                  </li>
                </ul>
              </li>
              <li>
                <span class="folder">Folder 2</span>
                <ul>
                  <li>
                    <span class="folder">Subfolder 2.1</span>
                    <ul id="folder21">
                      <li>
                        <span class="file">File 2.1.1</span>
                      </li>
                      <li>
                        <span class="file">File 2.1.2</span>
                      </li>
                    </ul>
                  </li>
                  <li>
                    <span class="file">File 2.2</span>
                  </li>
                </ul>
              </li>
              <li class="closed">
                <span class="folder">Folder 3 (closed at start)</span>
                <ul>
                  <li>
                    <span class="file">File 3.1</span>
                  </li>
                </ul>
              </li>
              <li>
                <span class="file">File 4</span>
              </li>
            </ul>
          </div><!-- <a href="#" id="hide-left" style="position: absolute;float: right">
            <img src="assets/img/left-btn.png">
          </a> -->
          <div id="chat" style="height: 380px; clear: right; background-color: rgba(0, 0, 0, .2);box-shadow: inset 1px 1px 0 rgba(0, 0, 0, .1),; background-color: #FFFFFF">                 
            blah!blah!blah!
          </div>
        </div>
        <div class="span8" style="height: 800px; margin-left:0">
          <div id="tabs">
            <ul>
              <li>
                <a href="#editor">Untitled</a>
              </li>
              <li style="cursor: pointer;">
                <a href="#new">+</a>
              </li>
            </ul>
            <div id="editor"></div>
          </div>
        </div>
        <div class="span2" style="height: 800px; margin: 0;">
          <div id="comment" style="margin-left: 10px;">
            <div style="background-color: gray">
              <div style="background-color: #FFFFFF; margin-top: 20px;display: block;border: solid transparent;border-width: 1px 1px 1px 6px">
                <img src="assets/img/silhouette.png" height="24" width="24" alt="" style="position: absolute">
                <div style="font-family: Arial,sans-serif,sans;font-size: 13px; font-weight: bold; margin-left: 32px;">
                  Charlie
                </div>
                <div style="margin: 3px 0 0 32px;font: normal 13px arial,sans-serif;color: #666;">
                  4:55 PM Today
                </div>
                <div style="background-color: transparent; color: #666666">
                  test
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
